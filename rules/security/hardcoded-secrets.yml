rules:
  - id: hardcoded-password
    languages: [javascript, typescript, python, java, go]
    message: Hardcoded password detected
    severity: ERROR
    patterns:
      - pattern: |
          password = "$VALUE"
      - pattern: |
          pwd = "$VALUE"
      - pattern: |
          passwd = "$VALUE"
      - pattern-regex: |
          (?:password|pwd|passwd)\s*[:=]\s*["'][^"']{4,}["']
    metadata:
      category: security
      cwe: "CWE-798"
      owasp: "A02:2021 - Cryptographic Failures"
      confidence: HIGH
      description: "Hardcoded passwords in source code can be easily discovered and exploited"
      references:
        - "https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password"
        - "https://cwe.mitre.org/data/definitions/798.html"

  - id: hardcoded-api-key
    languages: [javascript, typescript, python, java, go]
    message: Hardcoded API key detected
    severity: ERROR
    patterns:
      - pattern: |
          api_key = "$VALUE"
      - pattern: |
          apikey = "$VALUE"
      - pattern: |
          secret_key = "$VALUE"
      - pattern-regex: |
          (?:api[_-]?key|secret[_-]?key|access[_-]?token)\s*[:=]\s*["'][A-Za-z0-9]{20,}["']
    metadata:
      category: security
      cwe: "CWE-798"
      confidence: HIGH
      description: "Hardcoded API keys should be stored in environment variables or secure configuration"

  - id: hardcoded-jwt-secret
    languages: [javascript, typescript, python, java]
    message: Hardcoded JWT secret detected
    severity: ERROR
    patterns:
      - pattern: |
          jwtSecret = "$VALUE"
      - pattern: |
          JWT_SECRET = "$VALUE"
      - pattern-regex: |
          (?:jwt[_-]?secret|JWT[_-]?SECRET)\s*[:=]\s*["'][^"']{10,}["']
    metadata:
      category: security
      cwe: "CWE-798"
      confidence: HIGH
      description: "JWT secrets should be stored in secure environment variables"

  - id: aws-credentials
    languages: [javascript, typescript, python, java]
    message: Hardcoded AWS credentials detected
    severity: ERROR
    patterns:
      - pattern: |
          aws_access_key_id = "$VALUE"
      - pattern: |
          aws_secret_access_key = "$VALUE"
      - pattern-regex: |
          (?:aws[_-]?access[_-]?key[_-]?id|aws[_-]?secret[_-]?access[_-]?key)\s*[:=]\s*["'][^"']+["']
    metadata:
      category: security
      cwe: "CWE-798"
      confidence: HIGH
      description: "AWS credentials should be stored in environment variables or AWS credentials file"